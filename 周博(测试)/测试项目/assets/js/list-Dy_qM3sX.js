import{H as I,c as S,j as e,e as o,C as w,r as s,o as j,k as m,i as v}from"../index-DYxDfolO.js";const{get:O,post:P,put:G,delt:z}=I,f="/shiftKf",D=p=>O(`${f}/findAll`,p),h=p=>z(`${f}/${p}`),F=p=>P(`${f}/saveOrUpdateKf`,p),M=["_"],Q={class:"mid-action mb0"},J={__name:"list",setup(p){function y(l){return l.switchUserIds=l.users.map(a=>a.userId).join(","),l.switchUserNames=l.users.map(a=>a.name).join(","),l.workCycle=l.workCycle.join(","),F(l)}function x(l,a){var c;l=JSON.parse(JSON.stringify(l)),l.switchUserIds=l.switchUserIds.split(","),l.switchUserNames=l.switchUserNames.split(","),l.users=[],(c=l.switchUserIds)==null||c.forEach((_,k)=>{l.users.push({userId:_,name:l.switchUserNames[k]})}),l.workCycle=l.workCycle.split(","),a.action(l)}return(l,a)=>{const c=s("BaInput"),_=s("el-button"),k=s("Upload"),u=s("BaFormItem"),N=s("SelectStaff"),T=s("BaCheckboxGroup"),g=s("el-time-select"),C=s("TextareaExtend"),B=s("el-card"),$=s("BaDialog"),r=s("el-table-column"),R=s("el-image"),q=s("TagEllipsis"),V=s("TableOperateBtn"),E=s("RequestChartTable");return j(),S("div",{_:l.$store.setBusininessDesc("<div>支持排班的微信客服，更智能</div>")},[e(E,{ref:"rctRef",request:w(D),searchBtnType:"icon"},{query:o(({query:d})=>[e(c,{label:"客服名称",prop:"kfName",modelValue:d.kfName,"onUpdate:modelValue":b=>d.kfName=b},null,8,["modelValue","onUpdate:modelValue"])]),operation:o(({selectedIds:d,getList:b,goRoute:i,apiConfirm:U})=>[v("div",Q,[e(_,{type:"primary",onClick:a[0]||(a[0]=t=>l.$refs.dialogRef.action())},{default:o(()=>[...a[1]||(a[1]=[m("新建客服",-1)])]),_:1}),e(_,{type:"primary",plain:"",disabled:!(d!=null&&d.length),onClick:t=>U(w(h))},{default:o(()=>[...a[2]||(a[2]=[m("批量删除",-1)])]),_:1},8,["disabled","onClick"])]),e($,{ref:"dialogRef",dynamicTitle:"客服",width:"900",formProps:{"label-width":"100px"},onConfirm:({confirm:t})=>t(y,b)},{form:o(({form:t})=>[e(c,{label:"客服名称",prop:"kfName",required:"",modelValue:t.kfName,"onUpdate:modelValue":n=>t.kfName=n,maxlength:"15"},null,8,["modelValue","onUpdate:modelValue"]),e(u,{prop:"kfPicUrl",label:"客服头像",required:""},{default:o(()=>[e(k,{fileUrl:t.kfPicUrl,"onUpdate:fileUrl":n=>t.kfPicUrl=n,type:"image"},{tip:o(()=>[...a[3]||(a[3]=[v("div",null,"建议大小 2M 以内，仅支持 png/jpg 等图片类型",-1)])]),_:1},8,["fileUrl","onUpdate:fileUrl"])]),_:2},1024),e(u,{label:"接待员工",prop:"users",required:""},{default:o(()=>[e(N,{modelValue:t.users,"onUpdate:modelValue":n=>t.users=n},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),e(u,{label:"接待时间",prop:"",required:""},{default:o(()=>[e(B,{class:"box-card roster-card"},{default:o(()=>[e(T,{label:"工作周期",prop:"workCycle",required:"",modelValue:t.workCycle,"onUpdate:modelValue":n=>t.workCycle=n,options:[{label:"周一",value:"1"},{label:"周二",value:"2"},{label:"周三",value:"3"},{label:"周四",value:"4"},{label:"周五",value:"5"},{label:"周六",value:"6"},{label:"周日",value:"7"}]},null,8,["modelValue","onUpdate:modelValue"]),e(u,{label:"时间段"},{default:o(()=>[e(g,{modelValue:t.beginTime,"onUpdate:modelValue":n=>t.beginTime=n,start:"00:00",end:"23:59",step:"00:30",style:{width:"160px"},"max-time":t.endTime,placeholder:"选择时间"},null,8,["modelValue","onUpdate:modelValue","max-time"]),a[4]||(a[4]=m(" —— ",-1)),e(g,{start:"00:00",end:"23:59",step:"00:30",style:{width:"160px"},"min-time":t.beginTime||null,modelValue:t.endTime,"onUpdate:modelValue":n=>t.endTime=n,placeholder:"选择时间"},null,8,["min-time","modelValue","onUpdate:modelValue"])]),_:2},1024),e(u,{label:"接待语"},{default:o(()=>[e(C,{modelValue:t.welcomeMsg,"onUpdate:modelValue":n=>t.welcomeMsg=n,maxlength:"200","show-word-limit":"",placeholder:"请输入接待语",autosize:{minRows:5,maxRows:20},clearable:""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024)]),_:2},1024),e(u,{label:"非工作时间接待语",prop:"oorWelcome",required:""},{default:o(()=>[e(C,{modelValue:t.oorWelcome,"onUpdate:modelValue":n=>t.oorWelcome=n,maxlength:"200","show-word-limit":"",placeholder:"请输入",autosize:{minRows:5,maxRows:20},clearable:""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:1},8,["onConfirm"])]),table:o(({apiConfirm:d,goRoute:b})=>[e(r,{prop:"kfName",label:"客服名称"}),e(r,{prop:"complainUserPhone",label:"客服二维码"},{default:o(({row:i})=>[e(R,{class:"size-[50px]","preview-src-list":[i.kfQrUrl],src:i.kfQrUrl,fit:"fill",lazy:!0},null,8,["preview-src-list","src"])]),_:1}),e(r,{prop:"kfUrl",label:"客服链接"}),e(r,{prop:"switchUserNames",label:"接待员工"},{default:o(({row:i})=>[e(q,{list:i.switchUserNames,emptyText:"-"},null,8,["list"])]),_:1}),e(r,{prop:"updateTime",label:"最近更新时间"}),e(r,{label:"操作",width:"280",fixed:"right"},{default:o(({row:i})=>[e(V,{type:"",onClick:U=>x(i,l.$refs.dialogRef)},{default:o(()=>[...a[5]||(a[5]=[m("编辑",-1)])]),_:1},8,["onClick"]),e(V,{type:"",onClick:U=>l.$sdk.downloadBlob(i.kfQrUrl,i.kfName+".png","image")},{default:o(()=>[...a[6]||(a[6]=[m(" 二维码下载 ",-1)])]),_:1},8,["onClick"]),e(V,{type:"",onClick:U=>d(w(h),i.id)},{default:o(()=>[...a[7]||(a[7]=[m("删除",-1)])]),_:1},8,["onClick"])]),_:2},1024)]),_:1},8,["request"])],8,M)}}};export{J as default};
