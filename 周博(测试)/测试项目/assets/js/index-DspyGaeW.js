import{H as C,_ as b,c as P,j as i,e as o,r as a,o as v,i as m,k as _,w as z,P as I}from"../index-DYxDfolO.js";const{get:h,post:T,put:de,delt:L}=C,d="/msg",W=t=>h(`${d}/findMsgAuditByPage`,t),j=t=>h(`${d}/findAiAnalysisMsgAudits`,t),B=t=>h(`${d}/findMsgRules`,t),F=t=>T(`${d}/saveOrUpdateMsgRule`,t),J=()=>h(`${d}/synchMsg`),Y=t=>h(`${d}/buildAISessionWarning`,t),E=t=>L(`${d}/${t}`),H=t=>T(`${d}/${t}`),S=Object.freeze(Object.defineProperty({__proto__:null,batchStartOrStop:H,buildAISessionWarning:Y,del:E,findAiAnalysisMsgAudits:j,findMsgRules:B,getList:W,saveOrUpdateMsgRule:F,synchMsg:J},Symbol.toStringTag,{value:"Module"})),{get:pe,post:ge,put:ce,delt:fe}=C;let{saveOrUpdateMsgRule:A}={};const G={props:{data:{}},data(){return{saveOrUpdateMsgRule:A}=S,{rules:{ruleContent:[{required:!0,message:"请输入规则内容",trigger:"blur"}]},form:{ruleType:2,id:null,ruleContent:""}}},created(){this.data!=null&&(console.log(this.data.id),console.log(this.data.ruleContent),this.form.ruleContent=this.data.ruleContent,this.form.id=this.data.id)},methods:{async submit(){if(!await this.$refs.form.validate())return;let e=JSON.parse(JSON.stringify(this.form));A(e).then(({data:l})=>{this.msgSuccess("操作成功")}).finally(()=>{this.$store.loading=!1})}}},K={class:""};function X(t,e,l,n,s,g){const c=a("el-input"),u=a("el-form-item"),f=a("el-form");return v(),P("div",K,[i(f,{ref:"form",rules:s.rules,model:s.form,"label-position":"right","label-width":"100px","scroll-into-view-options":!0},{default:o(()=>[i(u,{label:"规则内容",prop:"ruleContent"},{default:o(()=>[i(c,{type:"textarea",rows:4,modelValue:s.form.ruleContent,"onUpdate:modelValue":e[0]||(e[0]=p=>s.form.ruleContent=p),maxlength:"100","show-word-limit":"",clearable:"",placeholder:"请输入"},null,8,["modelValue"]),e[1]||(e[1]=m("br",null,null,-1)),e[2]||(e[2]=m("span",{style:{color:"#f00","font-size":"12px"}}," 请清晰填写相关规则 ",-1))]),_:1})]),_:1},8,["rules","model"])])}const Z=b(G,[["render",X]]);let{saveOrUpdateMsgRule:ee,buildAISessionWarning:$}={};const te={props:{data:{}},data(){return{saveOrUpdateMsgRule:ee,buildAISessionWarning:$}=S,{rules:{time:[{required:!0,message:"请输入员工与客户的聊天时间段",trigger:"blur"}]},form:{time:null}}},methods:{formatDate(t){const e=t.getFullYear(),l=(t.getMonth()+1).toString().padStart(2,"0"),n=t.getDate().toString().padStart(2,"0");return`${e}-${l}-${n}`},async submit(){var e,l;let t=await this.$refs.form.validate();console.log(t),t&&$({msgAuditType:2,startTime:this.formatDate((e=this.form.time)==null?void 0:e[0]),endTime:this.formatDate((l=this.form.time)==null?void 0:l[1])}).then(({data:n})=>{this.msgSuccess("操作成功")}).finally(()=>{this.$store.loading=!1})}}},le={class:""};function se(t,e,l,n,s,g){const c=a("el-date-picker"),u=a("el-form-item"),f=a("el-form");return v(),P("div",le,[i(f,{ref:"form",rules:s.rules,model:s.form,"label-position":"right","label-width":"100px","scroll-into-view-options":!0},{default:o(()=>[i(u,{label:"时间:",prop:"time","aria-required":"true"},{default:o(()=>[i(c,{modelValue:s.form.time,"onUpdate:modelValue":e[0]||(e[0]=p=>s.form.time=p),type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期"},null,8,["modelValue"]),e[1]||(e[1]=m("br",null,null,-1)),e[2]||(e[2]=m("span",{style:{color:"#f00","font-size":"12px"}}," 请选择员工与客户指定时间段内的聊天内容进行预审 ",-1))]),_:1})]),_:1},8,["rules","model"])])}const ie=b(te,[["render",se]]);let{getList:M,findAiAnalysisMsgAudits:R,synchMsg:q,buildAISessionWarning:N,findMsgRules:w,del:V,saveOrUpdateMsgRule:re,batchStartOrStop:D}={};const ae={data(){return{getList:M,findAiAnalysisMsgAudits:R,synchMsg:q,buildAISessionWarning:N,findMsgRules:w,del:V,saveOrUpdateMsgRule:re,batchStartOrStop:D}=S,{activeName:"first",list:"",aiList:"",aiRuleList:"",total:0,aiTotal:0,aiRuleTotal:0,multipleSelection:[],loading:!1,dialogVisible:!1,dialogAiVisible:!1,form:{},queryParm:{fromName:null,acceptName:null,time:null,acceptType:2,page:1,size:10},aiQueryParm:{warning:null,employeeName:null,customerName:null,msgAuditType:2,time:null,page:1,size:10},aiRuleParm:{ruleStatus:null,ruleType:2,page:1,size:10},options:[],xData:[],series:[],tabCount:{},options:[{key:"全部",val:null},{key:"违规",val:!0},{key:"不违规",val:!1}],aiRuleOptions:[{key:"全部",val:null},{key:"启用",val:!0},{key:"停用",val:!1}]}},components:{aev:Z,synch:ie},watch:{},created(){this.getList(),this.getData(),this.findAiAnalysisMsgAudits(),this.findMsgRules()},mounted(){},methods:{openDialog(){this.dialogAiVisible=!0},getList(t){t==null&&(t=this.queryParm),this.$store.loading=!0,console.log(t),M(t).then(e=>{this.list=e.data,this.total=e.count,this.multipleSelection=[]}).catch(e=>console.error(e)).finally(()=>this.$store.loading=!1)},del(t){let e=t;this.$confirm().then(()=>(this.$store.loading=!0,V(e).then(l=>{this.msgSuccess("删除成功"),this.findMsgRules()}))).catch(l=>{console.error(l)})},findAiAnalysisMsgAudits(t){t==null&&(t=this.aiQueryParm),this.$store.loading=!0,console.log(t),R(t).then(({data:e,count:l})=>{this.aiList=e,this.aiTotal=+l,this.multipleSelection=[]}).catch(e=>console.error(e)).finally(()=>this.$store.loading=!1)},findMsgRules(t){t==null&&(t=this.aiRuleParm),this.$store.loading=!0,console.log(t),w(t).then(({data:e,count:l})=>{this.aiRuleList=e,this.aiRuleTotal=+l,this.multipleSelection=[]}).catch(e=>console.error(e)).finally(()=>this.$store.loading=!1)},submit(){this.loading=!0,this.$refs.aev.submit().then(()=>(this.dialogVisible=!1,this.findMsgRules())).catch(t=>console.error(t)).finally(()=>this.loading=!1)},submitAiVisible(){this.loading=!0,this.$refs.synch.submit().then(()=>{this.dialogAiVisible=!1}).catch(t=>console.error(t)).finally(()=>this.loading=!1)},synchChatMsg(){q().then(t=>{this.msgSuccess(t.msg)}).catch(t=>console.error(t)).finally(()=>this.$store.loading=!1)},buildAISessionWarning(){N().then(t=>{this.msgSuccess(t.msg)}).catch(t=>console.error(t)).finally(()=>this.$store.loading=!1)},getData(){var e,l;var t={fromName:this.queryParm.fromName,acceptName:this.queryParm.acceptName,startTime:this.queryParm.time===null?null:this.formatDate((e=this.queryParm.time)==null?void 0:e[0]),endTime:this.queryParm.time===null?null:this.formatDate((l=this.queryParm.time)==null?void 0:l[1]),acceptType:2,page:this.queryParm.page,size:this.queryParm.size};this.getList(t)},getAIData(){var e,l;var t={warning:this.aiQueryParm.warning,employeeName:this.aiQueryParm.employeeName,customerName:this.aiQueryParm.customerName,startTime:this.aiQueryParm.time===null?null:this.formatDate((e=this.aiQueryParm.time)==null?void 0:e[0]),endTime:this.aiQueryParm.time===null?null:this.formatDate((l=this.aiQueryParm.time)==null?void 0:l[1]),msgAuditType:2,page:this.aiQueryParm.page,size:this.aiQueryParm.size};this.findAiAnalysisMsgAudits(t)},getAIRuleData(){var t={ruleStatus:this.aiRuleParm.ruleStatus,ruleType:2,page:this.aiRuleParm.page,size:this.aiRuleParm.size};this.findMsgRules(t)},restting(){this.queryParm.fromName=null,this.queryParm.acceptName=null,this.queryParm.time=null,this.getData()},resttingAi(){this.aiQueryParm.warning=null,this.aiQueryParm.employeeName=null,this.aiQueryParm.customerName=null,this.aiQueryParm.time=null,this.getAIData()},resttingRuleAi(){this.aiRuleParm.ruleStatus=null,this.getAIRuleData()},formatDate(t){const e=t.getFullYear(),l=(t.getMonth()+1).toString().padStart(2,"0"),n=t.getDate().toString().padStart(2,"0");return`${e}-${l}-${n}`},formatWarning(t,e,l){return l?"违规":"不违规"},formatStartOrStop(t,e,l){return l?"启用":"停用"},formatDefaultRule(t,e,l){return l?"默认":"非默认"},formatDateTimeRange(t,e){return!t||!e?"-":`${t} 至 ${e}`},handleStatusChange(){var t,e;console.log((e=(t=this.multipleSelection)==null?void 0:t.join)==null?void 0:e.call(t,",")),this.$confirm("是否需要启用或停用该条规则").then(()=>{var l,n;return D((n=(l=this.multipleSelection)==null?void 0:l.join)==null?void 0:n.call(l,",")).then(s=>{this.msgSuccess("操作成功"),this.findMsgRules()})}).catch(l=>{console.error(l)})}}},oe={class:"g-card"},ne={class:"fxbw"};function ue(t,e,l,n,s,g){const c=a("el-input"),u=a("el-form-item"),f=a("el-date-picker"),p=a("el-button"),k=a("el-form"),y=a("el-table-column"),O=a("el-table"),U=a("pagination"),x=a("el-tabs");return v(),P("div",null,[i(x,{modelValue:s.activeName,"onUpdate:modelValue":e[8]||(e[8]=r=>s.activeName=r)},{default:o(()=>[m("div",oe,[e[12]||(e[12]=m("div",{class:"warning"},[m("strong",null," 获取员工与客户在群中的聊天内容(目前:仅支持文字内容) ")],-1)),i(k,{class:"searchForm",ref:"searchForm",model:s.queryParm,"label-width":"",inline:""},{default:o(()=>[i(u,{label:"发送人:",prop:"value3"},{default:o(()=>[i(c,{modelValue:s.queryParm.fromName,"onUpdate:modelValue":e[0]||(e[0]=r=>s.queryParm.fromName=r),placeholder:""},null,8,["modelValue"])]),_:1}),i(u,{label:"所属群:",prop:"value3"},{default:o(()=>[i(c,{modelValue:s.queryParm.acceptName,"onUpdate:modelValue":e[1]||(e[1]=r=>s.queryParm.acceptName=r),placeholder:""},null,8,["modelValue"])]),_:1}),i(u,{label:"时间:"},{default:o(()=>[i(f,{modelValue:s.queryParm.time,"onUpdate:modelValue":e[2]||(e[2]=r=>s.queryParm.time=r),type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期"},null,8,["modelValue"])]),_:1}),i(u,null,{default:o(()=>[i(p,{type:"primary",onClick:g.getData},{default:o(()=>[...e[9]||(e[9]=[_("查询",-1)])]),_:1},8,["onClick"]),i(p,{onClick:g.restting},{default:o(()=>[...e[10]||(e[10]=[_("重置",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["model"]),m("div",ne,[i(p,{type:"primary",onClick:e[3]||(e[3]=r=>g.synchChatMsg())},{default:o(()=>[...e[11]||(e[11]=[_("同步会话",-1)])]),_:1})]),i(O,{data:s.list,"tooltip-effect":"dark","highlight-current-row":"",onSelectionChange:e[4]||(e[4]=r=>s.multipleSelection=r.map(Q=>Q.msgId))},{default:o(()=>[i(y,{label:"发送人",prop:"fromName","show-overflow-tooltip":""}),i(y,{label:"所属群",prop:"acceptName"}),i(y,{label:"发送内容",prop:"content","show-overflow-tooltip":""}),i(y,{label:"发送时间",prop:"msgTime"})]),_:1},8,["data"]),z(i(U,{total:s.total,page:s.queryParm.page,"onUpdate:page":e[5]||(e[5]=r=>s.queryParm.page=r),limit:s.queryParm.size,"onUpdate:limit":e[6]||(e[6]=r=>s.queryParm.size=r),onPagination:e[7]||(e[7]=r=>g.getList())},null,8,["total","page","limit"]),[[I,s.total>0]])])]),_:1},8,["modelValue"])])}const he=b(ae,[["render",ue],["__scopeId","data-v-35728441"]]);export{he as default};
