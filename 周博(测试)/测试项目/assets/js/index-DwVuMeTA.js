import{H as w,c as N,j as l,G as F,e as o,r as p,o as $,i as g,k as m,t as L,C as y,F as x,h as O,d as j,D as q}from"../index-DYxDfolO.js";const{get:C,post:E,put:z,delt:P}=w,b="/seas",A=r=>C(`${b}/findAll`,r),R=r=>C(`${b}/distribute/${r}`),S=r=>P(`${b}/batchDelete/${r}`),G=r=>{const u=new FormData;return u.append("allocateUsers",JSON.stringify(r.allocateUsers)),u.append("file",r.file),E(`${b}/importData`,u)},H=r=>C(`${b}/export`,r,{responseType:"blob"}),J={class:"flex justify-between items-center"},K={__name:"index",props:{type:{type:String,default:"1"}},setup(r){const u=q({0:"待添加",1:"待通过",2:"已通过"});return(s,t)=>{const _=p("el-input"),d=p("el-form-item"),U=p("el-option"),k=p("el-select"),V=p("el-button"),T=p("SelectStaff"),D=p("ImportDialog"),i=p("el-table-column"),v=p("TableOperateBtn"),B=p("RequestChartTable");return $(),N("div",null,[l(B,{ref:"rctRef",params:{operateType:r.type},request:A,searchBtnType:"icon"},F({query:o(({query:n})=>[l(d,{label:"电话号码",prop:"phoneNumber"},{default:o(()=>[l(_,{modelValue:n.phoneNumber,"onUpdate:modelValue":e=>n.phoneNumber=e,placeholder:"请输入",clearable:""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),l(d,{label:"客户备注",prop:"customerName"},{default:o(()=>[l(_,{modelValue:n.customerName,"onUpdate:modelValue":e=>n.customerName=e,placeholder:"请输入",clearable:""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),l(d,{label:"员工名称",prop:"userName"},{default:o(()=>[l(_,{modelValue:n.userName,"onUpdate:modelValue":e=>n.userName=e,placeholder:"请输入",clearable:""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),l(d,{label:"添加状态",prop:"currentState"},{default:o(()=>[l(k,{modelValue:n.currentState,"onUpdate:modelValue":e=>n.currentState=e,"popper-append-to-body":!1},{default:o(()=>[($(!0),N(x,null,O(y(u),(e,a)=>($(),j(U,{key:a,label:e,value:a},null,8,["label","value"]))),128))]),_:1},8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),table:o(({data:n})=>[l(i,{label:"电话号码",prop:"phoneNumber"}),l(i,{label:"客户备注",prop:"customerName"}),l(i,{label:"分配员工",prop:"allocateUserName"}),l(i,{label:"当前状态",prop:"operateTypeSub"},{default:o(({row:e})=>[m(L(y(u)[e.currentState]),1)]),_:1}),l(i,{label:"导入时间",prop:"createTime"}),l(i,{label:"操作",fixed:"right"},{default:o(({row:e})=>[l(v,{onClick:a=>{var c;return(c=s.$refs.rctRef)==null?void 0:c.apiConfirm(R,e.id,"是否确认提醒?")}},{default:o(()=>[...t[8]||(t[8]=[m(" 提醒 ",-1)])]),_:1},8,["onClick"]),l(v,{onClick:a=>s.$refs.rctRef.apiConfirm(S,e.id)},{default:o(()=>[...t[9]||(t[9]=[m("删除",-1)])]),_:1},8,["onClick"])]),_:1})]),_:2},[s.isSelect?void 0:{name:"operation",fn:o(({selectedIds:n})=>[g("div",J,[l(V,{type:"primary",onClick:t[0]||(t[0]=e=>{var a;return(a=s.$refs.ImportDialogRef)==null?void 0:a.$refs.dialogRef.action()})},{default:o(()=>[...t[4]||(t[4]=[m("导入客户",-1)])]),_:1}),l(D,{ref:"ImportDialogRef",title:"导入客户",downloadTemplateRequest:H,downloadFileName:"导入客户模板.xlsx",formProps:{rules:{users:[s.$sdk.ruleRequiredChange]}},onConfirm:t[1]||(t[1]=({form:e,loading:a,visible:c})=>G({allocateUsers:e.value.users.map(f=>({userId:f.id,name:f.name})),file:e.value.file}).then(()=>{var f;(f=s.$refs.rctRef)==null||f.getList(1),c.value=!1}).finally(()=>{a.value=!1}))},{default:o(({form:e})=>[l(d,{label:"选择员工",prop:"users"},{default:o(()=>[l(T,{modelValue:e.users,"onUpdate:modelValue":a=>e.users=a,title:"选择员工"},null,8,["modelValue","onUpdate:modelValue"]),t[5]||(t[5]=g("div",{class:"g-tip"},"公海客户平均分配给选择的员工",-1))]),_:2},1024)]),_:1},8,["downloadTemplateRequest","formProps"]),g("div",null,[l(V,{type:"primary",plain:"",disabled:!(n!=null&&n.length),onClick:t[2]||(t[2]=e=>{var a;return(a=s.$refs.rctRef)==null?void 0:a.apiConfirm(R,void 0,"是否确认批量提醒?")})},{default:o(()=>[...t[6]||(t[6]=[m(" 批量提醒 ",-1)])]),_:1},8,["disabled"]),l(V,{type:"primary",plain:"",disabled:!(n!=null&&n.length),onClick:t[3]||(t[3]=e=>{var a;return(a=s.$refs.rctRef)==null?void 0:a.apiConfirm(S)})},{default:o(()=>[...t[7]||(t[7]=[m(" 批量删除 ",-1)])]),_:1},8,["disabled"])])])]),key:"0"}]),1032,["params","request"])])}}};export{K as default};
