import{H as E,_ as w,c as b,j as r,e as s,r as i,o as a,i as v,a as H,F as P,h as k,d as T,k as g,t as C,w as O,P as G,f as K}from"../index-DYxDfolO.js";const{get:x,post:Q,put:fe,delt:ce}=E,q="/fileSecurity",W=o=>x(`${q}/findAll`,o),X=o=>Q(`${q}/synchInfo`,o),Z=()=>x(`${q}/getFileSecurityOperations`),$=()=>x(`${q}/getFileSecuritySources`),F=Object.freeze(Object.defineProperty({__proto__:null,getFileSecurityOperations:Z,getFileSecuritySources:$,getList:W,synchInfo:X},Symbol.toStringTag,{value:"Module"}));let{saveOrUpdateMsgRule:D}={};const ee={props:{data:{}},data(){return{saveOrUpdateMsgRule:D}=F,{rules:{ruleContent:[{required:!0,message:"请输入规则内容",trigger:"blur"}]},form:{ruleType:2,id:null,ruleContent:""}}},created(){this.data!=null&&(console.log(this.data.id),console.log(this.data.ruleContent),this.form.ruleContent=this.data.ruleContent,this.form.id=this.data.id)},methods:{async submit(){if(!await this.$refs.form.validate())return;let e=JSON.parse(JSON.stringify(this.form));D(e).then(({data:n})=>{this.msgSuccess("操作成功")}).finally(()=>{this.$store.loading=!1})}}},te={class:""};function le(o,e,n,u,t,d){const m=i("el-input"),f=i("el-form-item"),y=i("el-form");return a(),b("div",te,[r(y,{ref:"form",rules:t.rules,model:t.form,"label-position":"right","label-width":"100px","scroll-into-view-options":!0},{default:s(()=>[r(f,{label:"规则内容",prop:"ruleContent"},{default:s(()=>[r(m,{type:"textarea",rows:4,modelValue:t.form.ruleContent,"onUpdate:modelValue":e[0]||(e[0]=h=>t.form.ruleContent=h),maxlength:"100","show-word-limit":"",clearable:"",placeholder:"请输入"},null,8,["modelValue"]),e[1]||(e[1]=v("br",null,null,-1)),e[2]||(e[2]=v("span",{style:{color:"#f00","font-size":"12px"}}," 请清晰填写相关规则 ",-1))]),_:1})]),_:1},8,["rules","model"])])}const oe=w(ee,[["render",le]]);let{synchInfo:A}={};const re={props:{data:{}},data(){return{synchInfo:A}=F,{rules:{time:[{required:!0,message:"请输入同步的数据日期",trigger:"blur"}]},form:{time:null}}},methods:{formatDate(o){const e=o.getFullYear(),n=(o.getMonth()+1).toString().padStart(2,"0"),u=o.getDate().toString().padStart(2,"0");return`${e}-${n}-${u}`},async submit(){var e,n;let o=await this.$refs.form.validate();console.log(o),o&&A({startTime:this.formatDate((e=this.form.time)==null?void 0:e[0]),endTime:this.formatDate((n=this.form.time)==null?void 0:n[1])}).then(({data:u})=>{this.msgSuccess("操作成功")}).finally(()=>{this.$store.loading=!1})}}},se={class:""};function ie(o,e,n,u,t,d){const m=i("el-date-picker"),f=i("el-form-item"),y=i("el-form");return a(),b("div",se,[r(y,{ref:"form",rules:t.rules,model:t.form,"label-position":"right","label-width":"100px","scroll-into-view-options":!0},{default:s(()=>[r(f,{label:"时间:",prop:"time","aria-required":"true"},{default:s(()=>[r(m,{modelValue:t.form.time,"onUpdate:modelValue":e[0]||(e[0]=h=>t.form.time=h),type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期"},null,8,["modelValue"]),e[1]||(e[1]=v("br",null,null,-1)),e[2]||(e[2]=v("span",{style:{color:"#f00","font-size":"12px"}}," 开始日期与结束日期不可超过14天 ",-1))]),_:1})]),_:1},8,["rules","model"])])}const ne=w(re,[["render",ie]]);let{getList:L,synchMsg:U,getFileSecurityOperations:N,getFileSecuritySources:M}={};const ae={data(){return{getList:L,synchMsg:U,getFileSecurityOperations:N,getFileSecuritySources:M}=F,{activeName:"first",list:"",aiList:"",aiRuleList:"",total:0,multipleSelection:[],loading:!1,dialogVisible:!1,dialogAiVisible:!1,form:{},queryParmTime:null,queryParm:{userType:null,operateType:null,opreateSource:null,time:null,page:1,size:10},options:[],xData:[],series:[],tabCount:{},options:[],sourceOptions:[],userTypeptions:[{key:"微信用户",val:1},{key:"企微用户",val:2},{key:"企业员工",val:3}]}},components:{aev:oe,synch:ne},watch:{},created(){this.getOperations(),this.getList()},mounted(){},methods:{openDialog(){this.dialogAiVisible=!0},getOperations(){N().then(o=>{this.options=o.data,console.log(o.data)}),M().then(o=>{this.sourceOptions=o.data,console.log(o.data)})},getList(){var o,e,n,u,t,d;this.$store.loading=!0,console.log((o=this.queryParmTime)==null?void 0:o[0]),console.log((e=this.queryParmTime)==null?void 0:e[1]),(n=this.queryParmTime)!=null&&n[0]&&((u=this.queryParmTime)!=null&&u[1])&&(this.queryParm.startTime=this.formatDate((t=this.queryParmTime)==null?void 0:t[0]),this.queryParm.endTime=this.formatDate((d=this.queryParmTime)==null?void 0:d[1])),L(this.queryParm).then(m=>{this.list=m.data,this.total=m.count,this.multipleSelection=[]}).catch(m=>console.error(m)).finally(()=>this.$store.loading=!1)},submit(){this.loading=!0,this.$refs.aev.submit().then(()=>(this.dialogVisible=!1,this.findMsgRules())).catch(o=>console.error(o)).finally(()=>this.loading=!1)},synchChatMsg(){U().then(o=>{this.msgSuccess(o.msg)}).catch(o=>console.error(o)).finally(()=>this.$store.loading=!1)},restting(){this.queryParm.userType=null,this.queryParm.operateType=null,this.queryParm.opreateSource=null,this.queryParmTime=null,this.getList()},formatDate(o){const e=o.getFullYear(),n=(o.getMonth()+1).toString().padStart(2,"0"),u=o.getDate().toString().padStart(2,"0");return`${e}-${n}-${u}`},submitAiVisible(){this.loading=!0,this.$refs.synch.submit().then(()=>{this.dialogAiVisible=!1}).catch(o=>console.error(o)).finally(()=>this.loading=!1)}}},ue={class:"g-card"},me={class:"fxbw"};function pe(o,e,n,u,t,d){const m=i("el-date-picker"),f=i("el-form-item"),y=i("el-option"),h=i("el-select"),S=i("el-button"),z=i("el-form"),_=i("el-table-column"),I=i("el-table"),B=i("pagination"),j=i("synch"),R=i("el-dialog"),J=i("el-tabs"),Y=H("loading");return a(),b("div",null,[r(J,{modelValue:t.activeName,"onUpdate:modelValue":e[11]||(e[11]=l=>t.activeName=l)},{default:s(()=>[v("div",ue,[r(z,{class:"searchForm",ref:"searchForm",model:o.query2,"label-width":"",inline:""},{default:s(()=>[r(f,{label:"时间:"},{default:s(()=>[r(m,{modelValue:t.queryParmTime,"onUpdate:modelValue":e[0]||(e[0]=l=>t.queryParmTime=l),type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期"},null,8,["modelValue"])]),_:1}),r(f,{label:"操作类型:",prop:"value1"},{default:s(()=>[r(h,{modelValue:t.queryParm.operateType,"onUpdate:modelValue":e[1]||(e[1]=l=>t.queryParm.operateType=l),"collapse-tags":"","collapse-tags-tooltip":"","max-collapse-tags":2,placeholder:"全部",style:{width:"260px"}},{default:s(()=>[(a(!0),b(P,null,k(t.options,l=>(a(),T(y,{key:l.value,label:l.value,value:l.subCode},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),r(f,{label:"操作来源:",prop:"value2"},{default:s(()=>[r(h,{modelValue:t.queryParm.opreateSource,"onUpdate:modelValue":e[2]||(e[2]=l=>t.queryParm.opreateSource=l),"collapse-tags":"","collapse-tags-tooltip":"","max-collapse-tags":2,placeholder:"全部",style:{width:"260px"}},{default:s(()=>[(a(!0),b(P,null,k(t.sourceOptions,l=>(a(),T(y,{key:l.value,label:l.value,value:l.subCode},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),r(f,{label:"用户类型:",prop:"value3"},{default:s(()=>[r(h,{modelValue:t.queryParm.userType,"onUpdate:modelValue":e[3]||(e[3]=l=>t.queryParm.userType=l),"collapse-tags":"","collapse-tags-tooltip":"","max-collapse-tags":2,placeholder:"全部",style:{width:"260px"}},{default:s(()=>[(a(!0),b(P,null,k(t.userTypeptions,l=>(a(),T(y,{key:l.val,label:l.key,value:l.val},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),r(f,null,{default:s(()=>[r(S,{type:"primary",onClick:d.getList},{default:s(()=>[...e[12]||(e[12]=[g("查询",-1)])]),_:1},8,["onClick"]),r(S,{onClick:d.restting},{default:s(()=>[...e[13]||(e[13]=[g("重置",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["model"]),v("div",me,[r(S,{type:"primary",onClick:e[4]||(e[4]=l=>{t.form={},t.dialogAiVisible=!0})},{default:s(()=>[...e[14]||(e[14]=[g("同步",-1)])]),_:1})]),r(I,{data:t.list,"tooltip-effect":"dark","highlight-current-row":"",onSelectionChange:e[5]||(e[5]=l=>t.multipleSelection=l.map(p=>p.id))},{default:s(()=>[r(_,{label:"文件操作时间",prop:"operateTime"}),r(_,{label:"文件操作人",prop:"userName"}),r(_,{label:"用户类型",prop:"userType"},{default:s(({row:l})=>{var p,c;return[g(C((c=(p=t.userTypeptions)==null?void 0:p.find(V=>V.val==l.userType))==null?void 0:c.key),1)]}),_:1}),r(_,{label:"文件操作类型",prop:"operateType"},{default:s(({row:l})=>{var p,c;return[g(C((c=(p=t.options)==null?void 0:p.find(V=>V.subCode==l.operateType))==null?void 0:c.value),1)]}),_:1}),r(_,{label:"文件操作类型",prop:"opreateSource"},{default:s(({row:l})=>{var p,c;return[g(C((c=(p=t.sourceOptions)==null?void 0:p.find(V=>V.subCode==l.opreateSource))==null?void 0:c.value),1)]}),_:1}),r(_,{label:"文件操作说明",prop:"operateFileInfo"})]),_:1},8,["data"]),O(r(B,{total:t.total,page:t.queryParm.page,"onUpdate:page":e[6]||(e[6]=l=>t.queryParm.page=l),limit:t.queryParm.size,"onUpdate:limit":e[7]||(e[7]=l=>t.queryParm.size=l),onPagination:e[8]||(e[8]=l=>d.getList())},null,8,["total","page","limit"]),[[G,t.total>0]]),r(R,{title:"同步",modelValue:t.dialogAiVisible,"onUpdate:modelValue":e[10]||(e[10]=l=>t.dialogAiVisible=l),width:"80%","close-on-click-modal":!1},{footer:s(()=>[r(S,{onClick:e[9]||(e[9]=l=>t.dialogAiVisible=!1)},{default:s(()=>[...e[15]||(e[15]=[g("取消",-1)])]),_:1}),O((a(),T(S,{type:"primary",onClick:d.submitAiVisible},{default:s(()=>[...e[16]||(e[16]=[g("确定",-1)])]),_:1},8,["onClick"])),[[Y,t.loading]])]),default:s(()=>[t.dialogAiVisible?(a(),T(j,{key:0,data:t.form,ref:"synch"},null,8,["data"])):K("",!0)]),_:1},8,["modelValue"])])]),_:1},8,["modelValue"])])}const ge=w(ae,[["render",pe],["__scopeId","data-v-cbdf2bb7"]]);export{ge as default};
