import{g as C,d as T,s as G}from"./category-DvOjyH99.js";import{_ as w,r as n,o as d,c as p,i as r,d as _,e as s,k as a,f as g,F as I,h as x,l as A,t as B,j as l,A as v,b as L}from"../index-DYxDfolO.js";const S={props:{type:{type:String,required:!0},selected:{type:[Array,String],default:""},isDisabledAction:{type:Boolean,default:!1},moduleType:{type:String,default:"1"}},data(){return{groupList:[],groupVisible:!1,groupForm:{mediaType:this.type,name:""},groupRules:{name:[{required:!0,message:"请输入分组名称",trigger:"blur"},{min:1,max:15,message:"长度在 1 到 15 个字符",trigger:"blur"}]},delObj:{updateOrDel:1,moduleType:+this.moduleType,ids:[]},loading:!0,activeId:0}},watch:{},computed:{},created(){this.getTree(!0)},mounted(){},methods:{addGroup(){this.groupForm={mediaType:this.type,name:""},this.groupVisible=!0},switchGroup(i,e){this.activeId=e.id,this.$emit("currentChange",e)},onAddOrUpdateGroup(){this.$refs.groupForm.validate(i=>{if(this.groupForm.id){let e={id:this.groupForm.id,name:this.groupForm.name,mediaType:this.type};this.groupForm=e}i&&G(this.groupForm).then(e=>{this.groupVisible=!1,this.groupForm={name:"",mediaType:this.type},this.$refs.groupForm.clearValidate(),this.getTree()})})},editGroup(i){this.groupForm=JSON.parse(JSON.stringify(i)),this.groupVisible=!0},removeGroup(i){this.$confirm("是否确认删除当前分组？删除后该分组下内容将移动到默认分组中，该操作不可撤销，请谨慎操作。").then(()=>{T(i).then(e=>{i==this.activeId?(this.activeId=void 0,this.getTree(!0)):this.getTree()})}).catch(()=>{})},getTree(i){C(this.type).then(({data:e})=>{e.forEach(m=>{m.children=null}),this.groupList=e,i&&(this.activeId=e[0].id,this.$emit("currentChange",e[0]))})}}},N={class:"h100"},O={class:"leftRight"},D={class:"left g-card"},R={class:"title"},U={class:"item-list"},j=["onClick"],E={class:"name"},q={key:0},z={class:"right"},J={class:"dialog-footer"};function P(i,e,m,M,o,u){const c=n("IconBtn"),y=n("el-input"),b=n("el-form-item"),k=n("el-form"),f=n("el-button"),V=n("el-drawer");return d(),p("div",N,[r("div",O,[r("div",D,[r("div",R,[e[4]||(e[4]=r("div",{class:"title-name"},"分组",-1)),m.isDisabledAction?g("",!0):(d(),_(c,{key:0,icon:"ElIconPlus",onClick:u.addGroup},{default:s(()=>[...e[3]||(e[3]=[a("新增分组",-1)])]),_:1},8,["onClick"]))]),r("div",U,[(d(!0),p(I,null,x(o.groupList,(t,F)=>(d(),p("div",{class:A(["item",{active:o.activeId==t.id}]),key:t.id,onClick:h=>u.switchGroup(F,t)},[r("div",E,B(t.name),1),t.id!=0&&!m.isDisabledAction?(d(),p("div",q,[l(c,{icon:"el-icon-edit",onClick:v(h=>u.editGroup(t),["stop"])},{default:s(()=>[...e[5]||(e[5]=[a("编辑",-1)])]),_:1},8,["onClick"]),l(c,{icon:"el-icon-delete",onClick:v(h=>u.removeGroup(t.id),["stop"])},{default:s(()=>[...e[6]||(e[6]=[a("删除",-1)])]),_:1},8,["onClick"])])):g("",!0)],10,j))),128))])]),r("div",z,[L(i.$slots,"default",{},void 0,!0)])]),o.groupVisible?(d(),_(V,{key:0,title:`${o.groupForm.id?"修改":"新建"}分组`,modelValue:o.groupVisible,"onUpdate:modelValue":e[2]||(e[2]=t=>o.groupVisible=t),size:"30%"},{footer:s(()=>[r("div",J,[l(f,{onClick:e[1]||(e[1]=t=>o.groupVisible=!1)},{default:s(()=>[...e[7]||(e[7]=[a("取 消",-1)])]),_:1}),l(f,{type:"primary",onClick:u.onAddOrUpdateGroup},{default:s(()=>[...e[8]||(e[8]=[a("确 定",-1)])]),_:1},8,["onClick"])])]),default:s(()=>[l(k,{model:o.groupForm,rules:o.groupRules,ref:"groupForm"},{default:s(()=>[l(b,{label:"分组名称",prop:"name","label-width":"80px"},{default:s(()=>[l(y,{modelValue:o.groupForm.name,"onUpdate:modelValue":e[0]||(e[0]=t=>o.groupForm.name=t),clearable:"",autocomplete:"off",maxlength:"15","show-word-limit":""},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["title","modelValue"])):g("",!0)])}const Q=w(S,[["render",P],["__scopeId","data-v-669d5d15"]]);export{Q as default};
