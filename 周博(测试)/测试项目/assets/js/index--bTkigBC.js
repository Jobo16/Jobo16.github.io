import{H as D,s as x,r as n,o as k,d as T,e as s,j as t,C as f,i as r,t as c,D as R,c as I,F as V,k as C,f as U,_ as A}from"../index-DYxDfolO.js";const{get:q,post:N,put:Q,delt:W}=D,$="/kf",E=i=>q(`${$}/findSummaryKfMsgs`,i),K=i=>q(`${$}/findGroupAll`,i),L=i=>N(`${$}/summaryKfmsgByAi`,i),F={class:"flex items-center"},G={class:"ml10"},j=x({__name:"SelectCustomer",props:{title:{type:String,default:"选择客户"},isSigleSelect:{type:Boolean,default:!1}},emits:["confirm"],setup(i,{expose:u,emit:a}){const e=R(),p=R([]),_=a;return u({dialogRef:e}),(g,m)=>{const b=n("el-image"),y=n("el-table-column"),d=n("RequestChartTable"),v=n("BaDialog");return k(),T(v,{ref_key:"dialogRef",ref:e,width:"900","append-to-body":"",title:i.title,onConfirm:m[1]||(m[1]=({visible:o,loading:l})=>_("confirm",{visible:o,loading:l,selected:f(p)}))},{default:s(()=>[t(d,{isSigleSelect:i.isSigleSelect,ref:"rct",request:f(K),searchBtnType:"icon",onSelectionChange:m[0]||(m[0]=o=>p.value=o)},{table:s(({})=>[t(y,{label:"咨询客户",prop:"nickname","show-overflow-tooltip":""},{default:s(({row:o})=>[r("div",F,[t(b,{class:"flex-none",src:o.avatar,style:{width:"50px"}},null,8,["src"]),r("div",G,c(o.nickname),1)])]),_:1})]),_:1},8,["isSigleSelect","request"])]),_:1},8,["title"])}}}),H=["_"],M={class:"flex items-center"},P={class:"ml10"},z={class:"wrap-text"},J=x({__name:"index",setup(i){const u=R([]);return(a,e)=>{const p=n("el-input"),_=n("el-form-item"),g=n("el-button"),m=n("TagEllipsis"),b=n("BaDialog"),y=n("el-image"),d=n("el-table-column"),v=n("RequestChartTable");return k(),I(V,null,[e[6]||(e[6]=r("div",{class:"warning"},[r("strong",null,"基于客户会话内容，AI智能归纳聊天意图")],-1)),r("div",{_:a.$store.setBusininessDesc("")},[t(v,{ref:"rctRef",request:f(E),searchBtnType:"icon"},{query:s(({query:o})=>[t(_,{label:"客户名称",prop:"nickname"},{default:s(()=>[t(p,{modelValue:o.nickname,"onUpdate:modelValue":l=>o.nickname=l,placeholder:"请输入"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),operation:s(({selectedIds:o})=>[t(g,{type:"primary",onClick:e[0]||(e[0]=l=>a.$refs.dialogRef.action())},{default:s(()=>[...e[3]||(e[3]=[C("圈选客户记录",-1)])]),_:1}),t(b,{ref:"dialogRef",title:"圈选客户记录",width:"1000",rules:{externalUserIds:[{type:"array",...a.$sdk.ruleRequiredChange}]},onConfirm:e[2]||(e[2]=({form:l})=>a.$refs.dialogRef.confirm(f(L),a.$refs.rctRef.getList))},{form:s(({form:l})=>[t(_,{label:"选择客户",prop:"externalUserIds"},{default:s(()=>[a.isDetail?U("",!0):(k(),T(g,{key:0,class:"mr10",type:"primary",onClick:e[1]||(e[1]=S=>a.$refs.SelectCustomerRef.dialogRef.visible=!0)},{default:s(()=>[...e[4]||(e[4]=[C(" 选择客户 ",-1)])]),_:1})),t(m,{list:f(u),defaultProps:"nickname"},null,8,["list"]),e[5]||(e[5]=r("div",{class:"g-tip"},"选择服务记录中的咨询客户",-1)),t(j,{ref:"SelectCustomerRef",onConfirm:({visible:S,loading:w,selected:B})=>(u.value=B,l.externalUserIds=B.map(h=>h.externalUserId),a.$refs.dialogRef.formRef.validate(),S.value=!1,w.value=!1)},null,8,["onConfirm"])]),_:2},1024)]),_:1},8,["rules"])]),table:s(({data:o})=>[t(d,{label:"客户名称",fixed:"left",prop:""},{default:s(({row:l})=>[r("div",M,[t(y,{class:"flex-none",src:l.avatar,style:{width:"50px"}},null,8,["src"]),r("div",P,c(l.nickname),1)])]),_:1}),t(d,{label:"会话时间段","min-width":"100",prop:"switchUserName"},{default:s(({row:l})=>[C(c(l.startTime)+" ~ "+c(l.endTime),1)]),_:1}),t(d,{label:"分析时间",prop:"createTime",width:"180"}),t(d,{prop:"summaryContent",label:"AI总结"},{default:s(({row:l})=>[r("div",z,c(l.summaryContent),1)]),_:1})]),_:1},8,["request"])],8,H)],64)}}}),X=A(J,[["__scopeId","data-v-b8bd42ab"]]);export{X as default};
