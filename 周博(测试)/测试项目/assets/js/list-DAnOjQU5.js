import{f as R,d as w,s as D,g as $}from"./api-DMwJgIYp.js";import{s as q,E as P,r as d,o as u,c as m,j as t,e as l,k as s,t as f,C as g,i as r,F as v,h as C,d as N,D as S,Q as I,_ as E}from"../index-DYxDfolO.js";const j=["_"],F={class:"g-tip"},O={key:0,class:"gap10 gap5"},H={key:1},M={key:0,class:"gap10 gap5"},Q={key:1},G=q({__name:"list",setup(J){const x={1:"未处理",2:"已处理"},y=S([]),b=S({}),B=I(()=>(console.log(y.value),y.value&&y.value.trim()!==""?y.value:"未设置"));return P(async()=>{try{const o=await R();if(o.data&&Array.isArray(o.data)){const e=o.data.filter(_=>_&&typeof _.userName=="string").map(_=>_.userName).join(", ");y.value=e,b.value.users=o.data}}catch(o){console.error("获取员工数据失败:",o)}}),(o,e)=>{const _=d("el-option"),V=d("el-select"),p=d("el-form-item"),T=d("el-button"),h=d("SelectStaff"),k=d("BaDialog"),c=d("el-table-column"),U=d("TableOperateBtn"),A=d("RequestChartTable"),z=d("el-image");return u(),m("div",{_:o.$store.setBusininessDesc("<div>查看和管理客户投诉和处理详情</div>")},[t(A,{ref:"rct",request:g($),searchBtnType:"icon"},{query:l(({query:n})=>[t(p,{label:"处理状态",prop:"complainType"},{default:l(()=>[t(V,{modelValue:n.handleState,"onUpdate:modelValue":a=>n.handleState=a,"popper-append-to-body":!1},{default:l(()=>[(u(),m(v,null,C(x,(a,i)=>t(_,{key:i,label:a,value:i},null,8,["label","value"])),64))]),_:1},8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),operation:l(({selectedIds:n})=>[t(T,{type:"primary",onClick:e[0]||(e[0]=a=>o.$refs.dialogRef.action())},{default:l(()=>[...e[3]||(e[3]=[s("通知配置",-1)])]),_:1}),t(k,{ref:"dialogRef",title:"通知配置",width:"500",formProps:{"label-width":"auto"},rules:{users:{required:!0,message:"必选项",trigger:"change"}},onConfirm:e[2]||(e[2]=()=>o.$refs.dialogRef.confirm(()=>{var a;return g(D)((a=g(b).users)==null?void 0:a.map(i=>({userId:i.userId})))}))},{form:l(({})=>[t(p,{prop:"users",class:"w100",label:"投诉处理人"},{default:l(()=>[t(h,{modelValue:g(b).users,"onUpdate:modelValue":e[1]||(e[1]=a=>g(b).users=a)},null,8,["modelValue"]),r("div",F,[e[4]||(e[4]=s(" 当前投诉通知员工为: ",-1)),t(T,{type:"success",size:"small",plain:""},{default:l(()=>[s(f(g(B)),1)]),_:1})])]),_:1})]),_:1},512)]),table:l(({data:n})=>[t(c,{prop:"complainTypeContent",label:"投诉类型",align:"center"}),t(c,{prop:"complainUserPhone",label:"联系方式",align:"center"}),t(c,{prop:"complainTime",label:"投诉时间",align:"center"}),t(c,{prop:"groupNameRule",label:"处理状态",align:"center"},{default:l(({row:a})=>[s(f(x[a.handleState]),1)]),_:1}),t(c,{prop:"handleUserName",label:"处理人",align:"center"}),t(c,{prop:"handleTime",label:"处理时间",align:"center"}),t(c,{label:"操作",align:"center",width:"280",fixed:"right"},{default:l(({row:a})=>[t(U,{type:"",onClick:i=>o.$refs.dialogRefDetail.action(a)},{default:l(()=>[...e[5]||(e[5]=[s("详情",-1)])]),_:1},8,["onClick"]),t(U,{type:"",onClick:i=>g(w)(a.id).then(()=>o.msgSuccess())},{default:l(()=>[...e[6]||(e[6]=[s("通知",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["request"]),t(k,{ref:"dialogRefDetail",title:"详情",width:"500",formProps:{"label-position":"top",style:"display:grid;grid:auto / 1fr 1fr"}},{form:l(({form:n})=>[r("div",null,[t(p,null,{label:l(()=>[...e[7]||(e[7]=[r("span",{style:{color:"#ff0000","font-size":"16px"}},"投诉类型:",-1)])]),default:l(()=>[s(" "+f(x[n.handleState]),1)]),_:2},1024),t(p,null,{label:l(()=>[...e[8]||(e[8]=[r("span",{style:{color:"#ff0000","font-size":"16px"}},"投诉时间:",-1)])]),default:l(()=>[s(" "+f(n.complainTime),1)]),_:2},1024),t(p,null,{label:l(()=>[...e[9]||(e[9]=[r("span",{style:{color:"#ff0000","font-size":"16px"}},"联系方式:",-1)])]),default:l(()=>[s(" "+f(n.complainUserPhone?n.complainUserPhone:"-"),1)]),_:2},1024),t(p,null,{label:l(()=>[...e[10]||(e[10]=[r("span",{style:{color:"#ff0000","font-size":"16px"}},"投诉内容:",-1)])]),default:l(()=>[s(" "+f(n.complainUserContent?n.complainUserContent:"-"),1)]),_:2},1024),t(p,null,{label:l(()=>[...e[11]||(e[11]=[r("span",{style:{color:"#ff0000","font-size":"16px"}},"投诉举证:",-1)])]),default:l(()=>{var a;return[n.complainAnnexList&&n.complainAnnexList.length>0?(u(),m("div",O,[(u(!0),m(v,null,C((a=n.complainAnnexList)==null?void 0:a.filter(i=>i.annexType==1),(i,L)=>(u(),N(z,{key:L,src:i.annexUrl,style:{width:"80px",height:"80px"},fit:"fill",lazy:!0},null,8,["src"]))),128))])):(u(),m("span",H,"-"))]}),_:2},1024)]),r("div",null,[t(p,null,{label:l(()=>[...e[12]||(e[12]=[r("span",{style:{color:"#ff0000","font-size":"16px"}},"处理人:",-1)])]),default:l(()=>[s(" "+f(n.handleUserName?n.handleUserName:"-"),1)]),_:2},1024),t(p,null,{label:l(()=>[...e[13]||(e[13]=[r("span",{style:{color:"#ff0000","font-size":"16px"}},"处理时间:",-1)])]),default:l(()=>[s(" "+f(n.handleTime?n.handleTime:"-"),1)]),_:2},1024),t(p,null,{label:l(()=>[...e[14]||(e[14]=[r("span",{style:{color:"#ff0000","font-size":"16px"}},"处理内容:",-1)])]),default:l(()=>[s(" "+f(n.handleContent?n.handleContent:"-"),1)]),_:2},1024),t(p,null,{label:l(()=>[...e[15]||(e[15]=[r("span",{style:{color:"#ff0000","font-size":"16px"}},"处理证明:",-1)])]),default:l(()=>[n.complainAnnexList&&n.complainAnnexList.length>0?(u(),m("div",M,[(u(!0),m(v,null,C(n.complainAnnexList.filter(a=>a.annexType===2),(a,i)=>(u(),N(z,{key:i,src:a.annexUrl,fit:"fill",lazy:""},null,8,["src"]))),128))])):(u(),m("span",Q,"-"))]),_:2},1024)])]),_:1},512)],8,j)}}}),X=E(G,[["__scopeId","data-v-42fd590a"]]);export{X as default};
