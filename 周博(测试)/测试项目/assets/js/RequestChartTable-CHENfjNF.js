const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/js/ChartLine-SAtF9pnv.js","assets/js/index-Ck37RZNe.js","assets/index-DYxDfolO.js","assets/css/index-DwPq-yKK.css","assets/css/ChartLine-crq7fTg9.css","assets/js/ChartBar-DprDhF2s.js","assets/js/index-CtSVQMOO.js","assets/css/ChartBar-DL7AtpYl.css","assets/js/TimeButtonGroup-C1v0Eg6a.js","assets/css/TimeButtonGroup-V9BDBoPp.css"])))=>i.map(i=>d[i]);
import{_ as P,r as i,a as V,w as j,o,c as $,j as b,e as q,b as p,n as y,g as m,d,f as u,i as G,k as S,t as O,F as A,l as B,s as M,B as R,z as L}from"../index-DYxDfolO.js";const Q=M({components:{ChartLine:R(()=>L(()=>import("./ChartLine-SAtF9pnv.js"),__vite__mapDeps([0,1,2,3,4]))),ChartBar:R(()=>L(()=>import("./ChartBar-DprDhF2s.js"),__vite__mapDeps([5,1,2,3,6,7]))),TimeButtonGroup:R(()=>L(()=>import("./TimeButtonGroup-C1v0Eg6a.js"),__vite__mapDeps([8,2,3,9])))},props:{title:{},type:{type:String,default:"table"},params:{type:Object,default:()=>({})},request:{type:Function},isCreateRequest:{type:Boolean,default:!0},isTimeQuery:{type:Boolean},dealQueryFun:{type:Function,default:null},dealDataFun:{type:Function,default:null},dataKey:{type:String,default:"id"},requestExport:{type:Function,default:null},exportFileName:{type:String},legend:{type:[Array,String],default:null},option:{type:Object,default:null},searchBtnType:{type:[Boolean,String],default:void 0},isSigleSelect:{type:Boolean,default:!1}},data(){return{loading:!1,query:{pageNum:1,pageSize:10},response:{},data:[],xData:[],total:0,selectedIds:[]}},computed:{},watch:{params:{handler(e){this.query={pageNum:1,pageSize:10,...e}},immediate:!0,deep:!0}},created(){this.isCreateRequest&&!this.isTimeQuery&&this.getList()},mounted(){},methods:{getList(e){var r;this.loading=!0,this.type=="table"&&e&&(this.query.pageNum=e),this.dealQueryFun&&this.dealQueryFun(this.query);let t=JSON.parse(JSON.stringify(this.query));return t.dateRange?(t.startTime=(r=t.dateRange)==null?void 0:r[0],t.beginTime=t.dateRange[0],t.endTime=t.dateRange[1]):this.isTimeQuery||(delete t.beginTime,delete t.endTime),delete t.dateRange,t.page=t.pageNum,t.size=t.pageSize,this.request(t).then(a=>{let{rows:n,total:l,count:f,data:g}=a,h=g||n;this.type=="table"?(this.dealDataFun&&this.dealDataFun(h,a),this.response=a,this.data=h,this.total=+l||+f):(this.dealDataFun&&this.dealDataFun(h,this.data,this.xData,a),this.response=a)}).catch(a=>{console.error(a)}).finally(()=>{this.loading=!1})},reset(e){this.$refs[e].resetFields(),this.$emit("reset"),setTimeout(()=>{this.getList(1)},0)},remove(e,t){return this.apiConfirm(e,t,"是否确认删除当前数据？")},download(e,t,r="是否确认下载",a="zip"){e&&t&&this.$confirm(r).then(()=>{var n,l;return e((l=(n=this.selectedIds)==null?void 0:n.join)==null?void 0:l.call(n,","))}).then(n=>{this.downloadBlob(n,t,a)}).catch(function(){})},goRoute(e="aev",t){this.$router.push({path:e,query:typeof t=="string"?{id:t}:t})},apiConfirm(e,t,r="是否确认删除当前数据？"){return new Promise((a,n)=>{var l,f;if(!e)return n(this.msgError("无可用接口服务"));if(t??(t=(f=(l=this.selectedIds)==null?void 0:l.join)==null?void 0:f.call(l,",")),!t)return n(this.msgError("请先选择需要操作的数据"));r&&!r.includes("该操作不可撤销，请谨慎操作")&&(r+="该操作不可撤销，请谨慎操作。"),this.$confirm(r).then(()=>(this.loading=!0,e(t).then(g=>{this.msgSuccess(),this.getList()}))).catch(g=>{console.error(g)}).finally(()=>{this.loading=!1,a()})})}}}),K={key:0,class:"g-card-title justify-between"},J={key:0,class:"RequestChartTable-operation"};function U(e,t,r,a,n,l){var T;const f=i("CommonTopRight"),g=i("SearchResetButton"),h=i("el-form"),v=i("TimeButtonGroup"),F=i("el-button"),D=i("ChartLine"),k=i("ChartBar"),E=i("BaEmpty"),I=i("el-table-column"),N=i("el-table"),w=i("pagination"),z=V("loading");return j((o(),$("div",{class:B(["RequestChartTable",e.$slots.query||"g-card"])},[b(f,null,{default:q(()=>[p(e.$slots,"operate",y(m({selectedIds:e.selectedIds,response:e.response,getList:e.getList,apiConfirm:e.apiConfirm,goRoute:e.goRoute,download:e.download})),void 0,!0)]),_:3}),e.$slots.query?(o(),d(h,{key:0,model:e.query,ref:"queryForm",inline:"",class:"searchForm"},{default:q(()=>[p(e.$slots,"query",y(m({query:e.query})),void 0,!0),b(g,{onSearch:t[0]||(t[0]=s=>e.getList(1)),onReset:t[1]||(t[1]=s=>e.reset("queryForm")),type:e.searchBtnType},null,8,["type"])]),_:3},8,["model"])):u("",!0),G("div",{class:B(e.$slots.query&&"g-card")},[p(e.$slots,"title",y(m({query:e.query})),()=>[e.title?(o(),$("div",K,[S(O(e.title)+" ",1),e.isTimeQuery?(o(),d(v,{key:0,style:{display:"inline-flex"},isDiy:"",onSearch:t[2]||(t[2]=s=>(Object.assign(e.query,s),e.getList(1)))})):u("",!0)])):u("",!0)],!0),e.requestExport||e.$slots.queryMiddle||e.$slots.operation?(o(),$("div",J,[e.$slots.queryMiddle?(o(),d(h,{key:0,model:e.query,ref:"queryFormMiddle",inline:"",class:"query-wrap"},{default:q(()=>[p(e.$slots,"queryMiddle",y(m({query:e.query})),void 0,!0),e.searchBtnType!==!1?(o(),d(g,{key:0,onSearch:t[3]||(t[3]=s=>e.getList(1)),onReset:t[4]||(t[4]=s=>e.reset("queryFormMiddle")),type:e.searchBtnType},null,8,["type"])):u("",!0)]),_:3},8,["model"])):u("",!0),p(e.$slots,"operation",y(m({selectedIds:e.selectedIds,response:e.response,getList:e.getList,apiConfirm:e.apiConfirm,goRoute:e.goRoute})),void 0,!0),e.requestExport?(o(),d(F,{key:1,class:"export float-right",type:"primary",onClick:t[5]||(t[5]=s=>e.$exportData(e.requestExport.bind(null,e.query),e.exportFileName))},{default:q(()=>[...t[10]||(t[10]=[S(" 导出 Excel ",-1)])]),_:1})):u("",!0)])):u("",!0),e.type=="lineChart"?(o(),d(D,{key:1,xData:e.xData,legend:e.legend,series:e.data,option:e.option,bgLinearGradient:e.$attrs.bgLinearGradient},null,8,["xData","legend","series","option","bgLinearGradient"])):"barChart".includes(e.type)?(o(),d(k,{key:2,xData:e.xData,series:e.data,option:e.option},null,8,["xData","series","option"])):e.type=="table"?(o(),$(A,{key:3},[p(e.$slots,"default",y(m({data:e.data,query:e.query,getList:e.getList,apiConfirm:e.apiConfirm,goRoute:e.goRoute})),void 0,!0),e.$slots.default&&!((T=e.data)!=null&&T.length)?(o(),d(E,{key:0})):u("",!0),e.$slots.table?(o(),d(N,{key:1,data:e.data,onSelectionChange:t[6]||(t[6]=s=>(e.selectedIds=s.map(C=>C[e.dataKey]),e.$emit("selectionChange",s)))},{default:q(()=>[b(I,{type:"selection",width:"50",selectable:s=>{var C;return e.selectedIds.includes(s[e.dataKey])||!(e.isSigleSelect&&((C=e.selectedIds)!=null&&C.length))}},null,8,["selectable"]),p(e.$slots,"table",y(m({query:e.query,getList:e.getList,apiConfirm:e.apiConfirm,goRoute:e.goRoute})),void 0,!0)]),_:3},8,["data"])):u("",!0),p(e.$slots,"pagination",y(m({total:e.total,query:e.query,getList:e.getList})),()=>[b(w,{style:{"margin-bottom":"-20px"},total:e.total,page:e.query.pageNum,"onUpdate:page":t[7]||(t[7]=s=>e.query.pageNum=s),limit:e.query.pageSize,"onUpdate:limit":t[8]||(t[8]=s=>e.query.pageSize=s),onPagination:t[9]||(t[9]=s=>e.getList())},null,8,["total","page","limit"])],!0)],64)):u("",!0)],2)],2)),[[z,e.loading]])}const W=P(Q,[["render",U],["__scopeId","data-v-d41b4dd3"]]);export{W as default};
