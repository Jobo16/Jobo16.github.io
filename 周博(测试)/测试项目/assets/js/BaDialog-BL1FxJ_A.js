import{s as k,L as F,u as J,r as v,a as K,o as u,d as c,e as n,w as B,c as _,b as y,n as g,g as C,y as D,f as R,j as x,k as V,D as f,M as z}from"../index-DYxDfolO.js";const E={class:"h100"},M=k({__name:"BaDialog",props:{idKey:{type:String,default:"id"},dynamicTitle:{type:String,default:""},rules:{type:Object,default:()=>({})},formProps:{type:Object,default:()=>({})},isFooter:{type:Boolean,default:!0}},emits:["confirm","cancel"],setup(s,{expose:N,emit:P}){const p=P,a=f(!1),l=f(!1),m=z({visible:a,loading:l}),t=f({}),r=f();F(()=>a.value,o=>{o||(l.value=o)});function O(o={},e){a.value=!0,t.value=JSON.parse(JSON.stringify(o)),e==null||e()}const T=J();async function b(){T.form&&await r.value.validate(),l.value=!0,p("confirm",{form:t,visible:a,loading:l,confirm:S})}function S(o,e,d,i="id"){l.value=!0,(t.value[i]&&d||o)(t.value).then(()=>{e==null||e(),$sdk.msgSuccess(),a.value=!1}).finally(()=>l.value=!1)}return N({visible:a,form:t,action:O,confirm:S,formRef:r}),(o,e)=>{const d=v("el-form"),i=v("el-button"),j=v("el-dialog"),$=K("loading");return u(),c(j,{class:"BaDialog",title:s.dynamicTitle&&(t.value[s.idKey]?"编辑":"新增")+s.dynamicTitle,modelValue:a.value,"onUpdate:modelValue":e[1]||(e[1]=w=>a.value=w),"align-center":"",draggable:"","close-on-click-modal":"","destroy-on-close":""},{footer:n(()=>[s.isFooter?y(o.$slots,"footer",g(D({key:0},{form:t.value,formRef:r.value,refData:m})),()=>[x(i,{onClick:e[0]||(e[0]=w=>(p("cancel"),a.value=!1))},{default:n(()=>[...e[2]||(e[2]=[V("取消",-1)])]),_:1}),B((u(),c(i,{type:"primary",disabled:l.value,onClick:b},{default:n(()=>[...e[3]||(e[3]=[V("确定",-1)])]),_:1},8,["disabled"])),[[$,l.value]])]):R("",!0)]),default:n(()=>[B((u(),_("div",E,[y(o.$slots,"default",g(C({form:t.value,formRef:r.value,refData:m}))),o.$slots.form?(u(),c(d,D({key:0,ref_key:"formRef",ref:r,class:"dialogForm","label-width":"auto"},s.formProps,{model:t.value,rules:s.rules}),{default:n(()=>[y(o.$slots,"form",g(C({form:t.value,formRef:r.value,refData:m})))]),_:3},16,["model","rules"])):R("",!0)])),[[$,l.value]])]),_:3},8,["title","modelValue"])}}});export{M as default};
