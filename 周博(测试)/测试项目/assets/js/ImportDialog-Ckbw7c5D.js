import{_ as F,r as d,o as f,d as g,e as r,j as k,i as m,c as v,t as _,f as $,k as w,b as B,n as b,g as N}from"../index-DYxDfolO.js";const R={props:{format:{type:Array,default:()=>["xlsx","xls"]},maxSize:{type:Number,default:50},downloadTemplateRequest:{type:Function,default:void 0},downloadFileName:{type:String,default:""}},data(){return{file:{}}},mounted(){},methods:{downloadTemplate(t){t.loading=!0,this.downloadTemplateRequest().then(e=>{e&&this.downloadBlob(e,this.downloadFileName)}).finally(()=>{t.loading=!1})},changeFile(t,e,l){let s=t.target.files[0];this.checkFile(s)&&(e.file=s,l.validateField("file"))},checkFile(t){const{size:e,name:l}=t,a=new RegExp(`\\.(${this.format.join("|")})$`,"ig").test(l),n=e/1024/1024<this.maxSize;return a||this.msgError(`上传文件只能是 ${this.format.join(",")} 格式!`),n||this.msgError(`上传文件大小不能超过 ${this.maxSize}MB!`),a&&n},importFile({form:t,refData:e}){this.checkFile(this.file)&&this.$emit("confirm",{form:t,refData:e,...this.$data})}}},S={class:"flex justify-between items-center"},T=["onChange"];function z(t,e,l,s,a,n){const u=d("el-button"),x=d("el-form-item"),y=d("BaDialog");return f(),g(y,{ref:"dialogRef",width:"600px"},{form:r(({form:o,formRef:C,refData:c})=>[k(x,{label:"选择表格",prop:"file",rules:[t.$sdk.ruleRequiredChange]},{default:r(()=>{var p,h;return[m("div",S,[m("div",null,[m("input",{class:"hidden",ref:"input",type:"file",onChange:i=>n.changeFile(i,o,C)},null,40,T),(p=o.file)!=null&&p.name?(f(),v("span",{key:0,class:"mr15",onClick:e[0]||(e[0]=i=>t.$refs.input.click())},_((h=o.file)==null?void 0:h.name),1)):$("",!0),k(u,{type:"default",plain:"",onClick:e[1]||(e[1]=i=>t.$refs.input.click())},{default:r(()=>{var i;return[w(_((i=o.file)!=null&&i.name?"重新上传":"上传表格"),1)]}),_:2},1024)]),l.downloadTemplateRequest?(f(),g(u,{key:0,text:"",onClick:i=>n.downloadTemplate(c)},{default:r(()=>[...e[2]||(e[2]=[w("模版下载",-1)])]),_:1},8,["onClick"])):$("",!0)])]}),_:2},1032,["rules"]),B(t.$slots,"default",b(N({form:o,refData:c})))]),_:3},512)}const q=F(R,[["render",z]]);export{q as default};
