import{_ as b,r as a,a as D,w as d,o as m,d as f,e as o,b as u,n as p,g as S,y as v,j as g,k as h,t as $,f as F,l as O,s as c}from"../index-DYxDfolO.js";const C=c({props:{modelValue:{type:[Object,Array],default:()=>({})},data:{type:Object,default:()=>({})},cancelButtonText:{type:String,default:"取 消"},confirmButtonText:{type:String,default:"确 定"},isOperate:{type:Boolean,default:!0}},components:{},data(){return{loading:!1,update:!1,formRef:{},form:{}}},computed:{isDetail(){return this.$route.path.endsWith("detail")}},watch:{modelValue:{handler(e){this.update=!1,this.form=JSON.parse(JSON.stringify(e))},immediate:!0,deep:!0},form:{handler(e,t){e==t&&(console.log("form change"),this.$emit("update:modelValue",e)),this.update=!0},deep:!0},data:{handler(e){JSON.stringify(e)!="{}"&&(this.form={...this.form,...JSON.parse(JSON.stringify(e))})},immediate:!0,deep:!0}},created(){},mounted(){},methods:{async submit(){await this.formRef.validate(),this.$store.loading=!0,this.$emit("submit",{form:this.form,loading:this.loading})},submitFn(e,t,r,i="id"){this.$store.loading=!0,(this.form[i]&&r||e)(this.form).then(()=>{t==null||t(),$sdk.msgSuccess()}).finally(()=>this.$store.loading=!1)}}});function N(e,t,r,i,R,w){const n=a("ElButton"),y=a("BaFormBar"),B=a("el-form"),l=D("loading");return d((m(),f(B,{class:O(["BaForm",e.isDetail&&"form-detail"]),model:e.form,"show-message":!e.isDetail,"scroll-to-error":"",disabled:e.isDetail,ref:s=>e.formRef=s,"label-width":"auto"},{default:o(()=>[u(e.$slots,"default",p(S({loading:e.loading,form:e.form,formRef:e.formRef,isDetail:e.isDetail,submitFn:e.submitFn}))),!e.isDetail&&e.isOperate?u(e.$slots,"operate",p(v({key:0},{loading:e.loading,form:e.form,formRef:e.formRef,isDetail:e.isDetail,submitFn:e.submitFn})),()=>[g(y,null,{default:o(()=>[g(n,{type:"primary",plain:"",onClick:t[0]||(t[0]=s=>e.$attrs.onCancel?e.$emit("cancel"):e.$router.back())},{default:o(()=>[h($(e.cancelButtonText),1)]),_:1}),d((m(),f(n,{type:"primary",disabled:e.$store.loading,onClick:t[1]||(t[1]=s=>e.submit())},{default:o(()=>[h($(e.confirmButtonText),1)]),_:1},8,["disabled"])),[[l,e.$store.loading]])]),_:1})]):F("",!0)]),_:3},8,["model","show-message","class","disabled"])),[[l,e.$store.loading]])}const T=b(C,[["render",N]]);export{T as default};
